
select t.trainno,t.tname,s1.stn as frcode,p1.name as frname,s1.timing as frtime,s2.stn as tocode,p2.name as toname,s2.timing as totime,t2.cls,t1.dt,t2.rate,t1.vacancy
from train t
inner join stops s1 on t.trainno=s1.tno
inner join stops s2 on s1.tno=s2.tno
inner join station p1 on p1.stn=s1.stn
inner join station p2 on p2.stn = s2.stn
inner join tktavailable t1 on t1.tno=s2.tno
inner join tktrate t2 on t1.tno=t2.tno AND t1.cls=t2.cls
and t2.fromstn=s1.stn and t2.tostn=s2.stn
where  t1.dt='2023-10-20' and s1.stn='TCR' AND s2.stn='TVC' AND s1.distance < s2.distance;

